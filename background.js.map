{"version":3,"file":"background.js","sources":["../src/background/background.ts"],"sourcesContent":["const MENU_IDS = {\n  page: 'qr_generate_from_page',\n  link: 'qr_generate_from_link',\n  image: 'qr_generate_from_image'\n} as const;\n\ntype MenuId = (typeof MENU_IDS)[keyof typeof MENU_IDS];\n\nfunction createMenus() {\n  chrome.contextMenus.removeAll(() => {\n    chrome.contextMenus.create({\n      id: MENU_IDS.page,\n      title: 'Generate QR from this page',\n      contexts: ['page']\n    });\n\n    chrome.contextMenus.create({\n      id: MENU_IDS.link,\n      title: 'Generate QR from this link',\n      contexts: ['link']\n    });\n\n    chrome.contextMenus.create({\n      id: MENU_IDS.image,\n      title: 'Generate QR from this image',\n      contexts: ['image']\n    });\n  });\n}\n\nchrome.runtime.onInstalled.addListener(() => {\n  createMenus();\n});\n\nchrome.contextMenus.onClicked.addListener(async (info: chrome.contextMenus.OnClickData, tab?: chrome.tabs.Tab) => {\n  const menuItemId = info.menuItemId as MenuId;\n  const tabId = tab?.id;\n  if (!tabId) return;\n\n  let payload: string | undefined;\n  let sourceType: string | undefined;\n\n  if (menuItemId === MENU_IDS.page) {\n    payload = info.pageUrl;\n    sourceType = 'contextPage';\n  } else if (menuItemId === MENU_IDS.link) {\n    payload = info.linkUrl;\n    sourceType = 'contextLink';\n  } else if (menuItemId === MENU_IDS.image) {\n    payload = info.srcUrl;\n    sourceType = 'contextImage';\n  }\n\n  if (!payload || !sourceType) return;\n\n  await chrome.storage.local.set({\n    pendingContext: {\n      payload,\n      sourceType,\n      at: Date.now()\n    }\n  });\n\n  await chrome.action.openPopup();\n});\n"],"names":["MENU_IDS","createMenus","info","tab","menuItemId","payload","sourceType"],"mappings":"AAAA,MAAMA,EAAW,CACf,KAAM,wBACN,KAAM,wBACN,MAAO,wBACT,EAIA,SAASC,GAAc,CACrB,OAAO,aAAa,UAAU,IAAM,CAClC,OAAO,aAAa,OAAO,CACzB,GAAID,EAAS,KACb,MAAO,6BACP,SAAU,CAAC,MAAM,CAAA,CAClB,EAED,OAAO,aAAa,OAAO,CACzB,GAAIA,EAAS,KACb,MAAO,6BACP,SAAU,CAAC,MAAM,CAAA,CAClB,EAED,OAAO,aAAa,OAAO,CACzB,GAAIA,EAAS,MACb,MAAO,8BACP,SAAU,CAAC,OAAO,CAAA,CACnB,CACH,CAAC,CACH,CAEA,OAAO,QAAQ,YAAY,YAAY,IAAM,CAC3CC,EAAA,CACF,CAAC,EAED,OAAO,aAAa,UAAU,YAAY,MAAOC,EAAuCC,IAA0B,CAChH,MAAMC,EAAaF,EAAK,WAExB,GAAI,EADUC,GAAA,YAAAA,EAAK,IACP,OAEZ,IAAIE,EACAC,EAEAF,IAAeJ,EAAS,MAC1BK,EAAUH,EAAK,QACfI,EAAa,eACJF,IAAeJ,EAAS,MACjCK,EAAUH,EAAK,QACfI,EAAa,eACJF,IAAeJ,EAAS,QACjCK,EAAUH,EAAK,OACfI,EAAa,gBAGX,GAACD,GAAW,CAACC,KAEjB,MAAM,OAAO,QAAQ,MAAM,IAAI,CAC7B,eAAgB,CACd,QAAAD,EACA,WAAAC,EACA,GAAI,KAAK,IAAA,CAAI,CACf,CACD,EAED,MAAM,OAAO,OAAO,UAAA,EACtB,CAAC"}